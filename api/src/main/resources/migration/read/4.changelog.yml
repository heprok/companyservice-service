databaseChangeLog:
  - changeSet:
      id: 4
      author: oleg@briolink.com
      changes:
        - createTable:
            tableName: user
            schemaName: ${readSchema}
            columns:
              - column:
                  name: id
                  type: varchar(100)
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: data
                  type: json
        - addColumn:
            tableName: connection
            schemaName: ${readSchema}
            afterColumn: industry_id
            columns:
              - column:
                  name: buyer_role
                  type: json
                  constraints:
                    nullable: false
              - column:
                  name: seller_role
                  type: json
                  constraints:
                    nullable: false
              - column:
                  name: buyer_role_name
                  type: varchar(255)
                  constraints:
                    nullable: false
              - column:
                  name: seller_role_name
                  type: varchar(255)
                  constraints:
                    nullable: false
              - column:
                  name: industry_name
                  type: varchar(255)
        - dropIndex:
            indexName: idx_connection_dates_end_collaboration
            schemaName: ${readSchema}
            tableName: connection
        - dropIndex:
            indexName: idx_connection_dates_start_collaboration
            schemaName: ${readSchema}
            tableName: connection
        - renameColumn:
            tableName: connection
            schemaName: ${readSchema}
            columnDataType: varchar(36)
            oldColumnName: service_ids
            newColumnName: service_id
        - renameColumn:
            tableName: connection
            schemaName: ${readSchema}
            columnDataType: Year
            oldColumnName: dates_start_collaboration
            newColumnName: start_collaboration
        - renameColumn:
            tableName: connection
            schemaName: ${readSchema}
            columnDataType: Year
            oldColumnName: dates_end_collaboration
            newColumnName: end_collaboration
        - dropNotNullConstraint:
            columnDataType: varchar(36)
            columnName: industry_id
            tableName: connection
            schemaName: ${readSchema}
        - dropNotNullConstraint:
            columnDataType: varchar(255)
            columnName: location
            tableName: connection
            schemaName: ${readSchema}
        - dropColumn:
            columnName: id
            columns:
              - column:
                  name: seller_role_id
              - column:
                  name: seller_role_name
              - column:
                  name: seller_role
              - column:
                  name: seller_name
            tableName: connection
            schemaName: ${readSchema}
        - dropPrimaryKey:
            constraintName: pk_connection
            dropIndex: true
            tableName: connection
            schemaName: ${readSchema}
        - addPrimaryKey:
            constraintName: pk_connection
            columnNames: id, service_id
            tableName: connection
            schemaName: ${readSchema}
